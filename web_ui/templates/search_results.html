{% extends "base.html" %}

{% block title %}Search Results{% endblock %}
{% block header %}Search Results{% endblock %}

{% block content %}
<div class="grid-container">
    {% for result in results %}
    <div class="card">
        {% if result.poster_path %}
        <img class="poster" src="https://image.tmdb.org/t/p/w185{{ result.poster_path }}" alt="Poster">
        {% else %}
        <div class="poster"
            style="height: 278px; background-color: #ccc; display: flex; align-items: center; justify-content: center;">
            <span>No Image</span>
        </div>
        {% endif %}

        <div class="title">
            <span class="media-icon">
                {% if result.media_type == "movie" %}ðŸŽ¬{% elif result.media_type == "tv" %}ðŸ“º{% endif %}
            </span>
            {{ result.name or result.title }}
        </div>

        <div class="badge {% if result.exists %}badge-success{% else %}badge-secondary{% endif %}">
            {% if result.exists %}In DB{% else %}New{% endif %}
        </div>

        {% if result.lastupdated %}
        <div class="timestamp">Last updated: {{ result.lastupdated.strftime('%Y-%m-%d %H:%M') }}</div>
        {% endif %}

        <div class="action">
            <form method="post" action="/search">
                <input type="hidden" name="tmdb_id" value="{{ result.id }}">
                <input type="hidden" name="media_type" value="{{ result.media_type }}">
                <button type="submit">
                    {% if result.exists %}Update{% else %}Insert{% endif %}
                </button>
            </form>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}