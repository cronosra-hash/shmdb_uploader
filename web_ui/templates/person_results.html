{% extends "base.html" %}

{% block title %}Person Search Results{% endblock %}

{% block content %}
<div class="page-wrapper">
  <h2 class="page-title">Search Results</h2>

  {% for person in people %}
    <div class="card fadeInUp">
      <div class="person-meta">
        {% if person.profile_path %}
          <img src="https://image.tmdb.org/t/p/w200{{ person.profile_path }}" alt="{{ person.name }}">
        {% endif %}
        <div class="person-details">
          <h3>{{ person.name }}</h3>
          <p><strong>Known for:</strong> {{ person.known_for_department }}</p>
          <p><strong>Birthday:</strong> {{ person.birthday or 'N/A' }}</p>
          <p><strong>Place of Birth:</strong> {{ person.place_of_birth or 'N/A' }}</p>
          {% if person.also_known_as %}
            <p><strong>Also Known As:</strong> {{ person.also_known_as | join(', ') }}</p>
          {% endif %}
          {% if person.biography %}
            <details>
              <summary>Biography</summary>
              <p>{{ person.biography }}</p>
            </details>
          {% endif %}
        </div>
      </div>

      {% if person.credits | length == 0 %}
        <span class="badge badge-warning">⚠ No credits found</span>
      {% endif %}

      <details class="credits-toggle" {% if person.credits | length > 0 %}open{% endif %}>
        <summary class="credits-summary">Credits</summary>
        <div class="credits-table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Title</th>
                <th>Type</th>
                <th>Date</th>
                <th>In DB</th>
              </tr>
            </thead>
            <tbody>
              {% for credit in person.credits %}
                <tr>
                  <td>{{ credit.title or credit.name }}</td>
                  <td>{{ credit.media_type | capitalize }}</td>
                  <td>{{ credit.release_date or credit.first_air_date or 'N/A' }}</td>
                  <td>
                    {% if credit.exists %}
                      <span class="badge badge-success">✅ In DB</span>
                    {% else %}
                      <span class="badge badge-secondary">❌ Not in DB</span>
                    {% endif %}
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </details>
    </div>
  {% endfor %}
</div>
{% endblock %}
